[
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#glms",
    "href": "slides/lecture04-3-zero-inflated.html#glms",
    "title": "Zero-Inflated Model Example",
    "section": "GLMs",
    "text": "GLMs\n\nUse linear model to specify (usually transformed) parameters of a non-Gaussian distribution.\nCan be more challenging to specify, interpret, and check.\nExamples: Poisson, Binomial regression, but almost unlimited combinations of distribution + link possible."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#be-cautious",
    "href": "slides/lecture04-3-zero-inflated.html#be-cautious",
    "title": "Zero-Inflated Model Example",
    "section": "Be Cautious…",
    "text": "Be Cautious…\n\n\n\nOver-relying on plots like histograms can lead to mis-specifying GLM dynamics.\nThink of linear regression: the question is not if the data are Gaussian but the residuals.\n\n\n\n\n\nBrain on Regression Meme\n\n\n\nSource: Richard McElreath"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#model-specification",
    "href": "slides/lecture04-3-zero-inflated.html#model-specification",
    "title": "Zero-Inflated Model Example",
    "section": "Model Specification",
    "text": "Model Specification\nWe might hypothesize that the number of fish caught is influenced by the number of children (noisy, distracting, impatient) and whether the party brought a camper.\n\\[\\begin{align*}\ny_i &\\sim \\text{Poisson}(\\lambda_i) \\\\\nf(\\lambda_i) &= \\beta_0 + \\beta_1 \\text{child}_i + \\beta_2 \\text{camper}_i\n\\end{align*}\n\\]\n\n\\(\\lambda_i\\): positive “rate”\n\\(f(\\cdot)\\): maps positive reals (rate scale) to all reals (linear model scale)"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#fitting-the-model",
    "href": "slides/lecture04-3-zero-inflated.html#fitting-the-model",
    "title": "Zero-Inflated Model Example",
    "section": "Fitting the Model",
    "text": "Fitting the Model\n\nfunction fish_model(params, child, camper, fish_caught)\n    β₀, β₁, β₂ = params\n    λ = exp.(β₀ .+ β₁ * child + β₂ * camper)\n    loglik = sum(logpdf.(Poisson.(λ), fish_caught))\nend\n\nlb = [-100.0, -100.0, -100.0]\nub = [100.0, 100.0, 100.0]\ninit = [0.0, 0.0, 0.0]\n\noptim_out = optimize(θ -&gt; -fish_model(θ, fish.child, fish.camper, fish.fish_caught), lb, ub, init)\nθ_mle = optim_out.minimizer\n@show round.(θ_mle; digits=2);\n@show round.(exp.(θ_mle); digits=2);\n\nround.(θ_mle; digits = 2) = [0.91, -1.23, 1.05]\nround.(exp.(θ_mle); digits = 2) = [2.48, 0.29, 2.87]"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#interpretation-of-coefficients",
    "href": "slides/lecture04-3-zero-inflated.html#interpretation-of-coefficients",
    "title": "Zero-Inflated Model Example",
    "section": "Interpretation of Coefficients",
    "text": "Interpretation of Coefficients\nSince \\(\\log(\\lambda_i) = \\sum_j \\beta_j x^i_j\\):\n\\(\\exp(\\beta_j)\\) says how much a unit increase in \\(x_j\\) multiplies the rate (hence expected value).\nSo \\(\\beta_1 =\\) -1.2 says that each extra child reduces the expected number of fish caught by a factor of 0.3."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#predictive-checks-to-evaluate-model",
    "href": "slides/lecture04-3-zero-inflated.html#predictive-checks-to-evaluate-model",
    "title": "Zero-Inflated Model Example",
    "section": "Predictive Checks To Evaluate Model",
    "text": "Predictive Checks To Evaluate Model\n\nLinear regression: model checking was straightforward: residuals should have been Gaussian distributed.\nGLMs: Less clear how to check distributional assumptions.\n\nStrategy: check predictive distribution of relevant summary statistic(s) by simulation; do you capture the empirical statistic?"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#predictive-checks",
    "href": "slides/lecture04-3-zero-inflated.html#predictive-checks",
    "title": "Zero-Inflated Model Example",
    "section": "Predictive Checks",
    "text": "Predictive Checks\nIn other words, for some statistic \\(T\\):\n\nEstimate \\(\\hat{T}\\) from the data.\nSimulate synthetic datasets using your model and calculate \\(\\tilde{T}_n\\) for each one;\nExamine the distribution of \\((\\tilde{T})\\) to see where \\(\\hat{T}\\) falls.\n\nTeaser: This is closely related to the idea of a \\(p\\)-value…"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#checking-proportion-of-zero-fish",
    "href": "slides/lecture04-3-zero-inflated.html#checking-proportion-of-zero-fish",
    "title": "Zero-Inflated Model Example",
    "section": "Checking Proportion of Zero Fish",
    "text": "Checking Proportion of Zero Fish\n\n\nFigure 2: Predictive distribution for fitted fish model."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#what-was-the-problem",
    "href": "slides/lecture04-3-zero-inflated.html#what-was-the-problem",
    "title": "Zero-Inflated Model Example",
    "section": "What Was The Problem?",
    "text": "What Was The Problem?\n\nThe model produces far fewer zero-fish counts than the data.\nThis is typical of a lot of environmental count data; often have far more zeros than would be expected from a Poisson regression.\nAlternative: Use a zero-inflated model."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#mixture-models",
    "href": "slides/lecture04-3-zero-inflated.html#mixture-models",
    "title": "Zero-Inflated Model Example",
    "section": "Mixture Models",
    "text": "Mixture Models\nWhen we have two different data-generating processes which produce the same observable outcome, may need to use a mixture of two distributions to capture outcome.\nDistribution 1: \\(\\mathcal{D}_1\\) with likelihood \\(L_1(\\theta_1 | y)\\).\nDistribution 2: \\(\\mathcal{D}_2\\) with likelihood \\(L_1(\\theta_2 | y)\\)."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#mixture-model-likelihood",
    "href": "slides/lecture04-3-zero-inflated.html#mixture-model-likelihood",
    "title": "Zero-Inflated Model Example",
    "section": "Mixture Model Likelihood",
    "text": "Mixture Model Likelihood\nThen if \\(y_i \\sim \\mathcal{D}_1\\) with probability \\(p_i\\), \\(y_i \\sim \\mathcal{D}_2\\) with probability \\(p_{i-1}\\).\n\\[L(p_i, \\theta_1, \\theta_2) = \\prod_{i=1}^n \\left(p_1 L_1(\\theta_1 | y_i) + p_2 L_2(\\theta_2 | y_i)\\right)\\]"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#fitting-mixture-models",
    "href": "slides/lecture04-3-zero-inflated.html#fitting-mixture-models",
    "title": "Zero-Inflated Model Example",
    "section": "Fitting Mixture Models",
    "text": "Fitting Mixture Models\nThis can get complicted (and require more complicated algorithms) when with many or similar mixture components. But our case is easier!"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#example-mixture-rationale",
    "href": "slides/lecture04-3-zero-inflated.html#example-mixture-rationale",
    "title": "Zero-Inflated Model Example",
    "section": "Example: Mixture Rationale",
    "text": "Example: Mixture Rationale\n\nSome groups don’t fish, which guarantees no fish.\nProbability of fishing is influenced by size of group.\nIf a group fishes, then there’s a Poisson process for the number of fish they catch.\nExpected fishing influenced by children and campers."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#zero-inflated-poisson",
    "href": "slides/lecture04-3-zero-inflated.html#zero-inflated-poisson",
    "title": "Zero-Inflated Model Example",
    "section": "Zero-Inflated Poisson",
    "text": "Zero-Inflated Poisson\nThis is a mixture between a Poisson and point-distribution (Dirac distribution) at zero.\n\\[\\begin{aligned}\ny_i &\\sim p_i \\text{Dirac}(0) + (1 - p_i) \\text{Poisson}(\\lambda_i)  \\\\\n\\text{logit}(p_i) &= \\alpha_0 + \\alpha_1 \\text{persons}_i\\\\\n\\log(\\lambda_i) &= \\beta_0 + \\beta_1 \\text{child}_i + \\beta_2 \\text{camper}_i\n\\end{aligned}\\]"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#zip-likelihood",
    "href": "slides/lecture04-3-zero-inflated.html#zip-likelihood",
    "title": "Zero-Inflated Model Example",
    "section": "ZIP Likelihood",
    "text": "ZIP Likelihood\nIf \\(y = 0\\):\n\\[\\mathcal{L}(p_i, \\lambda_i | y_i = 0) = p_i + (1 - p_i) \\overbrace{e^{-\\lambda_i}}^{\\text{Poisson zero likelihood}}\\]\nIf \\(y &gt; 0\\):\n\\[\\mathcal{L}(p_i, \\lambda_i | y_i &gt; 0) = (1 - p_i) \\underbrace{\\frac{\\lambda_i^{y_i}e^{-\\lambda_i}}{y_i!}}_{\\text{Poisson likelihood}}\\]"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#fitting-zip",
    "href": "slides/lecture04-3-zero-inflated.html#fitting-zip",
    "title": "Zero-Inflated Model Example",
    "section": "Fitting ZIP",
    "text": "Fitting ZIP\n\ninvlogit(x) = exp(x) / (1 + exp(x))\nZeroInflated(p, λ) = MixtureModel([Dirac(0), Poisson(λ)], [p, 1 - p])\nfunction fish_model_zip(params, persons, child, camper, fish_caught)\n    α₀, α₁, β₀, β₁, β₂ = params\n    p = invlogit.(α₀ .+ α₁ * persons)\n    λ = exp.(β₀ .+ β₁ * child .+ β₂ * camper)\n    ll = sum(logpdf.(ZeroInflated.(p, λ), fish_caught))\n    return ll\nend\n\nlb = [-100.0, -100.0, -100.0, -100.0, -100.0]\nub = [100.0, 0.0, 100.0, 100.0, 100.0]\ninit = [5.0, -2.0, 0.0, 0.0, 0.0]\n\noptim_out = optimize(θ -&gt; -fish_model_zip(θ, fish.persons, fish.child, fish.camper, fish.fish_caught), lb, ub, init)\nθ_mle = optim_out.minimizer\n@show round.(θ_mle; digits=2);\n@show round.(exp.(θ_mle); digits=2);\n\nround.(θ_mle; digits = 2) = [1.3, -0.56, 1.6, -1.04, 0.83]\nround.(exp.(θ_mle); digits = 2) = [3.66, 0.57, 4.94, 0.35, 2.3]"
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#evaluating-model-fit",
    "href": "slides/lecture04-3-zero-inflated.html#evaluating-model-fit",
    "title": "Zero-Inflated Model Example",
    "section": "Evaluating Model Fit",
    "text": "Evaluating Model Fit\n\n\nFigure 3: Predictive distribution for fitted fish model."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#interpretation-of-check",
    "href": "slides/lecture04-3-zero-inflated.html#interpretation-of-check",
    "title": "Zero-Inflated Model Example",
    "section": "Interpretation of Check",
    "text": "Interpretation of Check\n\nThis is much better, but is only one test.\nA model has more evidence for it if it passes multiple checks.\nBut none of this can “prove” a model is right: need to rely on hypotheses and EDA to propose a sensible model."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#key-points",
    "href": "slides/lecture04-3-zero-inflated.html#key-points",
    "title": "Zero-Inflated Model Example",
    "section": "Key Points",
    "text": "Key Points\n\nZero-inflation can address problems where data have more zeros than GLM distribution would suggest.\nSimple version of a mixture model."
  },
  {
    "objectID": "slides/lecture04-3-zero-inflated.html#upcoming-schedule",
    "href": "slides/lecture04-3-zero-inflated.html#upcoming-schedule",
    "title": "Zero-Inflated Model Example",
    "section": "Upcoming Schedule",
    "text": "Upcoming Schedule\nMonday: No class, enjoy break.\nNext Two Weeks: Extreme Values\nHW2: Due 2/20\nProject Proposal: Due 2/27"
  },
  {
    "objectID": "schedule.html",
    "href": "schedule.html",
    "title": "Class Schedule",
    "section": "",
    "text": "This page contains a schedule of the topics, content, and assignments for the semester. Note that this schedule will be updated as necessary the semester progresses, with all changes documented here.\nInstructions to save the slides as PDFs can be found here. The key is to hit E when the slides are open in your browser (ideally Chrome, but it may work in others) to toggle into PDF print mode.\nReadings can be accessed using the link (when needed, through the Cornell library with a Cornell login) or on Canvas.\n\n\n\n\n\n\n\n\n\n\n\n\n\nWeek\nDate\nTopic\nSlides\nReading\nHomework\nQuiz\nResources\n\n\n\n\n1\n1/21\nClass Introduction\n\nO’Hagan (2004)\n\n\n\n\n\n\n1/23\nProbability Review\n\n\n\n\n\n\n\n2\n1/26\nClass Canceled Due To Snow\n\nFranconeri et al. (2021)\n\n\n\n\n\n\n1/28\nExploratory Data Analysis\n\n\n\n\n\n\n\n\n1/30\nData Visualization\n\n\n\n\nData Viz\n\n\n3\n2/02\nLinear Regression\n\nShmueli (2010)\n\n\n\n\n\n\n2/04\nMore On Linear Regression\n\n\n\n\n\n\n\n\n2/06\nLinear Regression As A Probability Model\n\n\n\n\n\n\n\n4\n2/09\nLogistic Regression\n\n\n\n\n\n\n\n\n2/11\nGeneralized Linear Models\n\n\n\n\n\n\n\n\n2/13\nPoisson Regression Example\n\n\n\nQuiz 1"
  }
]